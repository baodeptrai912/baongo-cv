<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <link rel="shortcut icon" href="/favicon.png" type="image/x-icon">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notification Center</title>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Poppins:wght@500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <link href="/css/whole.css" rel="stylesheet">
    <script src="/js/Notification-filtering.js" defer></script>
    <script src="/js/FetchNotification.js" defer></script>
    <script src="/js/Toast.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.5.1/sockjs.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <meta name="_csrf" th:content="${_csrf.token}"/>
    <meta name="_csrf_header" th:content="${_csrf.headerName}"/>

    <style>
        :root {
            /* Modern Color Palette - Enhanced */
            --primary: #FF6B35;
            --primary-light: #FFF4F0;
            --primary-hover: #E85D2E;
            --primary-gradient: linear-gradient(135deg, #FF6B35 0%, #FF8F66 100%);

            --secondary: #4ECDC4;
            --success: #2ECC71;
            --warning: #F39C12;
            --danger: #E74C3C;
            --info: #3498DB;

            --bg-body: #F8F9FA;
            --bg-surface: #FFFFFF;
            --bg-hover: #F1F3F5;
            --bg-overlay: rgba(0, 0, 0, 0.5);

            --text-primary: #2C3E50;
            --text-secondary: #6C757D;
            --text-muted: #95A5A6;
            --text-white: #FFFFFF;

            --border-subtle: #E9ECEF;
            --border-medium: #DEE2E6;

            --shadow-xs: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.08);
            --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.12);
            --shadow-xl: 0 12px 32px rgba(0, 0, 0, 0.15);
            --shadow-primary: 0 4px 20px rgba(255, 107, 53, 0.25);

            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --radius-xl: 20px;
            --radius-pill: 9999px;

            --font-main: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            --font-heading: 'Poppins', sans-serif;

            --transition-base: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-fast: all 0.15s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, #F8F9FA 0%, #E9ECEF 100%);
            font-family: var(--font-main);
            color: var(--text-primary);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            line-height: 1.6;
            min-height: 100vh;
        }

        /* Layout Container */
        .notification-wrapper {
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 24px;
        }

        /* Enhanced Page Header */
        .page-header {
            background: var(--bg-surface);
            border-radius: var(--radius-xl);
            padding: 32px;
            margin-bottom: 32px;
            box-shadow: var(--shadow-md);
            position: relative;
            overflow: hidden;
            z-index: 1;
        }

        .page-header::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 300px;
            height: 300px;
            background: var(--primary-gradient);
            opacity: 0.08;
            border-radius: 50%;
            transform: translate(30%, -30%);
        }

        .header-content {
            position: relative;
            z-index: 1;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 24px;
        }

        .header-title-section h1 {
            font-family: var(--font-heading);
            font-weight: 800;
            font-size: 2.5rem;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .header-icon {
            width: 56px;
            height: 56px;
            background: var(--primary-light);
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary);
            font-size: 28px;
        }

        .header-subtitle {
            color: var(--text-secondary);
            font-size: 1rem;
            font-weight: 500;
        }

        /* Stats Cards */
        .stats-container {
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
        }

        .stat-card {
            background: var(--bg-surface);
            padding: 20px 28px;
            border-radius: var(--radius-lg);
            border: 2px solid var(--border-subtle);
            display: flex;
            align-items: center;
            gap: 16px;
            transition: var(--transition-base);
            min-width: 160px;
        }

        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-md);
            border-color: var(--primary);
        }

        .stat-icon {
            width: 48px;
            height: 48px;
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .stat-card.all .stat-icon {
            background: linear-gradient(135deg, #667EEA 0%, #764BA2 100%);
            color: white;
        }

        .stat-card.unread .stat-icon {
            background: var(--primary-gradient);
            color: white;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .stat-info h3 {
            font-size: 2rem;
            font-weight: 800;
            font-family: var(--font-heading);
            line-height: 1;
            margin-bottom: 4px;
        }

        .stat-info p {
            font-size: 0.875rem;
            color: var(--text-secondary);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin: 0;
        }

        /* Main Grid Layout */
        .layout-grid {
            display: grid;
            grid-template-columns: 280px 1fr;
            gap: 32px;
            align-items: start;
        }

        /* Enhanced Sidebar */
        .sidebar-filters {
            position: sticky;
            top: 24px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .filter-section {
            background: var(--bg-surface);
            padding: 24px;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-subtle);
            transition: var(--transition-base);
        }

        .filter-section:hover {
            box-shadow: var(--shadow-md);
        }

        .filter-header {
            font-size: 0.75rem;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--text-muted);
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .filter-header i {
            font-size: 14px;
        }

        .nav-link-custom {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 16px;
            border-radius: var(--radius-md);
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 600;
            font-size: 0.95rem;
            transition: var(--transition-base);
            margin-bottom: 6px;
            position: relative;
            overflow: hidden;
        }

        .nav-link-custom::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 4px;
            background: var(--primary-gradient);
            transform: scaleY(0);
            transition: var(--transition-base);
        }

        .nav-link-custom:hover {
            background: var(--bg-hover);
            color: var(--primary);
            transform: translateX(4px);
        }

        .nav-link-custom.active {
            background: var(--primary-light);
            color: var(--primary);
            font-weight: 700;
        }

        .nav-link-custom.active::before {
            transform: scaleY(1);
        }

        .nav-link-content {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .nav-link-content i {
            font-size: 16px;
            width: 20px;
            text-align: center;
        }

        .badge-count {
            background: var(--bg-hover);
            color: var(--text-secondary);
            font-size: 0.75rem;
            padding: 4px 10px;
            border-radius: var(--radius-pill);
            font-weight: 700;
            min-width: 28px;
            text-align: center;
        }

        .nav-link-custom.active .badge-count {
            background: var(--primary);
            color: white;
        }

        /* Notification Feed Area */
        .notification-feed {
            background: transparent;
        }

        .feed-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            padding: 0 4px;
        }

        .feed-title {
            font-size: 1.5rem;
            font-weight: 800;
            font-family: var(--font-heading);
            color: var(--text-primary);
            margin: 0;
        }

        .feed-actions {
            display: flex;
            gap: 12px;
        }

        .btn-action {
            border: 2px solid var(--border-medium);
            background: var(--bg-surface);
            color: var(--text-secondary);
            font-size: 0.875rem;
            font-weight: 600;
            padding: 10px 20px;
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: var(--transition-base);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-action:hover {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
            transform: translateY(-2px);
            box-shadow: var(--shadow-primary);
        }

        .btn-action i {
            font-size: 14px;
        }

        /* Notifications List */
        .notifications-list {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        /* Enhanced Notification Card */
        .notif-card {
            background: var(--bg-surface);
            border-radius: var(--radius-lg);
            padding: 24px;
            display: flex;
            gap: 20px;
            border: 2px solid transparent;
            box-shadow: var(--shadow-sm);
            transition: var(--transition-base);
            position: relative;
            text-decoration: none;
            color: inherit;
            overflow: hidden;
        }

        .notif-card::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            width: 5px;
            height: 100%;
            background: var(--primary-gradient);
            transform: scaleX(0);
            transition: var(--transition-base);
        }

        .notif-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
            border-color: rgba(255, 107, 53, 0.3);
        }

        .notif-card:hover::before {
            transform: scaleX(1);
        }

        .notif-card.unread {
            background: linear-gradient(to right, #FFF9F7 0%, #FFFFFF 100%);
            border-color: var(--primary);
        }

        .notif-card.unread::after {
            content: '';
            position: absolute;
            top: 24px;
            right: 24px;
            width: 12px;
            height: 12px;
            background: var(--primary-gradient);
            border-radius: 50%;
            box-shadow: 0 0 0 4px rgba(255, 107, 53, 0.2);
            animation: pulse-dot 2s infinite;
        }

        @keyframes pulse-dot {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.2); opacity: 0.8; }
        }

        /* Avatar with Status */
        .notif-avatar-wrapper {
            position: relative;
            flex-shrink: 0;
        }

        .notif-avatar {
            width: 56px;
            height: 56px;
            border-radius: var(--radius-lg);
            object-fit: cover;
            border: 3px solid var(--bg-surface);
            box-shadow: var(--shadow-sm);
        }

        .avatar-status {
            position: absolute;
            bottom: -2px;
            right: -2px;
            width: 16px;
            height: 16px;
            background: var(--success);
            border: 3px solid var(--bg-surface);
            border-radius: 50%;
        }

        /* Notification Content */
        .notif-content {
            flex: 1;
            min-width: 0;
        }

        .notif-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 10px;
            gap: 16px;
        }

        .notif-title {
            font-family: var(--font-heading);
            font-weight: 700;
            font-size: 1.125rem;
            color: var(--text-primary);
            line-height: 1.4;
            margin: 0;
        }

        .unread .notif-title {
            color: var(--primary);
        }

        .notif-time {
            font-size: 0.8rem;
            color: var(--text-muted);
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 6px;
            font-weight: 600;
        }

        .notif-time i {
            font-size: 12px;
        }

        .notif-message {
            color: var(--text-secondary);
            font-size: 0.95rem;
            line-height: 1.6;
            margin-bottom: 16px;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .notif-footer {
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
        }

        /* Enhanced Tags/Badges */
        .tag {
            font-size: 0.7rem;
            padding: 6px 12px;
            border-radius: var(--radius-pill);
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .tag i {
            font-size: 10px;
        }

        .tag-category {
            background: var(--primary-light);
            color: var(--primary);
        }

        .tag-user {
            background: linear-gradient(135deg, #667EEA 0%, #764BA2 100%);
            color: white;
        }

        .tag-time {
            background: var(--bg-hover);
            color: var(--text-secondary);
        }

        /* Empty State Enhanced */
        .empty-state {
            text-align: center;
            padding: 80px 40px;
            background: var(--bg-surface);
            border-radius: var(--radius-xl);
            border: 2px dashed var(--border-medium);
        }

        .empty-icon {
            font-size: 5rem;
            color: var(--border-medium);
            margin-bottom: 24px;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .empty-state h5 {
            font-family: var(--font-heading);
            font-weight: 700;
            font-size: 1.5rem;
            color: var(--text-primary);
            margin-bottom: 12px;
        }

        .empty-state p {
            color: var(--text-secondary);
            font-size: 1rem;
            margin: 0;
        }

        /* Modern Pagination */
        .pagination-wrapper {
            margin-top: 40px;
            display: flex;
            justify-content: center;
        }

        .pagination-custom {
            display: flex;
            gap: 8px;
            background: var(--bg-surface);
            padding: 8px;
            border-radius: var(--radius-pill);
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-subtle);
        }

        .page-link-custom {
            min-width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 600;
            font-size: 0.95rem;
            transition: var(--transition-base);
            padding: 0 12px;
        }

        .page-link-custom:hover {
            background: var(--bg-hover);
            color: var(--primary);
            transform: scale(1.1);
        }

        .page-link-custom.active {
            background: var(--primary-gradient);
            color: white;
            box-shadow: var(--shadow-primary);
            transform: scale(1.15);
        }

        .page-link-custom.disabled {
            opacity: 0.3;
            pointer-events: none;
        }

        /* Loading State */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--bg-overlay);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }

        .loading-overlay.active {
            display: flex;
        }

        .spinner {
            width: 60px;
            height: 60px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .layout-grid {
                grid-template-columns: 240px 1fr;
                gap: 24px;
            }
        }

        @media (max-width: 768px) {
            .notification-wrapper {
                padding: 24px 16px;
            }

            .page-header {
                padding: 24px;
            }

            .header-title-section h1 {
                font-size: 2rem;
            }

            .header-icon {
                width: 48px;
                height: 48px;
                font-size: 24px;
            }

            .layout-grid {
                grid-template-columns: 1fr;
                gap: 24px;
            }

            .sidebar-filters {
                position: static;
                flex-direction: row;
                overflow-x: auto;
                padding-bottom: 8px;
                gap: 12px;
                scrollbar-width: thin;
            }

            .filter-section {
                min-width: 200px;
            }

            .stats-container {
                width: 100%;
            }

            .stat-card {
                flex: 1;
                min-width: 140px;
            }

            .notif-card {
                padding: 20px;
                gap: 16px;
            }

            .notif-avatar {
                width: 48px;
                height: 48px;
            }

            .feed-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 16px;
            }

            .feed-actions {
                width: 100%;
            }

            .btn-action {
                flex: 1;
                justify-content: center;
            }
        }

        /* Scrollbar Styling */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-hover);
            border-radius: var(--radius-pill);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--text-muted);
            border-radius: var(--radius-pill);
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary);
        }

        /* Accessibility */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }

        /* Print Styles */
        @media print {
            .sidebar-filters,
            .feed-actions,
            .pagination-wrapper {
                display: none;
            }

            .notif-card {
                break-inside: avoid;
                box-shadow: none;
                border: 1px solid var(--border-medium);
            }
        }
    </style>
</head>
<body>

<div th:replace="~{fragments/headerAndFooter :: header}"></div>

<main class="flex-grow-1">
    <div class="notification-wrapper">

        <!-- Enhanced Page Header -->
        <header class="page-header">
            <div class="header-content">
                <div class="header-title-section">
                    <h1>
                        <span class="header-icon">
                            <i class="fas fa-bell"></i>
                        </span>
                        Notification Center
                    </h1>
                    <p class="header-subtitle">
                        <i class="fas fa-info-circle"></i>
                        Updates on important activities and events in the system
                    </p>
                </div>

                <div class="stats-container">
                    <div class="stat-card all">
                        <div class="stat-icon">
                            <i class="fas fa-inbox"></i>
                        </div>
                        <div class="stat-info">
                            <h3 th:text="${response.counts.all}">0</h3>
                            <p>All</p>
                        </div>
                    </div>

                    <div class="stat-card unread">
                        <div class="stat-icon">
                            <i class="fas fa-envelope"></i>
                        </div>
                        <div class="stat-info">
                            <h3 th:text="${response.counts.unread}">0</h3>
                            <p>Unread</p>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Layout Grid -->
        <div class="layout-grid">

            <!-- Enhanced Sidebar Filters -->
            <aside class="sidebar-filters">
                <!-- Status Filter -->
                <div class="filter-section">
                    <div class="filter-header">
                        <i class="fas fa-filter"></i>
                        Status
                    </div>
                    <a th:href="@{/notification/all(status='all', type=${currentType})}"
                       class="nav-link-custom" th:classappend="${currentStatus == 'all' ? 'active' : ''}">
                        <span class="nav-link-content">
                            <i class="fas fa-layer-group"></i>
                            <span>All</span>
                        </span>
                        <span class="badge-count" th:text="${response.counts.all}">0</span>
                    </a>
                    <a th:href="@{/notification/all(status='unread', type=${currentType})}"
                       class="nav-link-custom" th:classappend="${currentStatus == 'unread' ? 'active' : ''}">
                        <span class="nav-link-content">
                            <i class="fas fa-envelope"></i>
                            <span>Unread</span>
                        </span>
                        <span class="badge-count" th:text="${response.counts.unread}">0</span>
                    </a>
                    <a th:href="@{/notification/all(status='read', type=${currentType})}"
                       class="nav-link-custom" th:classappend="${currentStatus == 'read' ? 'active' : ''}">
                        <span class="nav-link-content">
                            <i class="fas fa-envelope-open"></i>
                            <span>Read</span>
                        </span>
                        <span class="badge-count" th:text="${response.counts.read}">0</span>
                    </a>
                </div>

                <!-- Type Filter -->
                <div class="filter-section">
                    <div class="filter-header">
                        <i class="fas fa-tags"></i>
                        Notification Type
                    </div>
                    <a th:href="@{/notification/all(status=${currentStatus}, type='all')}"
                       class="nav-link-custom" th:classappend="${currentType == 'all' ? 'active' : ''}">
                        <span class="nav-link-content">
                            <i class="fas fa-hashtag"></i>
                            <span>All Types</span>
                        </span>
                    </a>
                    <div th:each="entry : ${availableTypes}">
                        <a th:href="@{/notification/all(status=${currentStatus}, type=${entry.key})}"
                           class="nav-link-custom" th:classappend="${currentType == entry.key ? 'active' : ''}">
                            <span class="nav-link-content">
                                <i class="fas fa-tag"></i>
                                <span th:text="${#strings.capitalize(#strings.replace(entry.key, '_', ' ').toLowerCase())}"></span>
                            </span>
                            <span class="badge-count" th:text="${entry.value}">0</span>
                        </a>
                    </div>
                    <div th:if="${#maps.isEmpty(availableTypes)}" style="padding: 12px; color: var(--text-muted); font-size: 0.875rem; font-style: italic;">
                        <i class="fas fa-inbox"></i> No categories yet
                    </div>
                </div>
            </aside>

            <!-- Notification Feed -->
            <section class="notification-feed">
                <div class="feed-header">
                    <h2 class="feed-title">
                        <i class="fas fa-stream"></i> Recent Updates
                    </h2>
                    <div class="feed-actions">
                        <button class="btn-action" onclick="markAllAsRead()">
                            <i class="fas fa-check-double"></i>
                            Mark all as read
                        </button>
                        <button class="btn-action" onclick="window.location.reload()">
                            <i class="fas fa-sync-alt"></i>
                            Refresh
                        </button>
                    </div>
                </div>

                <div id="notifications-list-container" class="notifications-list">

                    <!-- Empty State -->
                    <th:block th:if="${response.notifications.content.isEmpty()}">
                        <div class="empty-state">
                            <div class="empty-icon">
                                <i class="fas fa-bell-slash"></i>
                            </div>
                            <h5>No notifications</h5>
                            <p>You're all caught up. We'll let you know when there's something new.</p>
                        </div>
                    </th:block>

                    <!-- Notification Cards -->
                    <th:block th:each="n : ${response.notifications.content}">
                        <a th:href="${n.href}" class="notif-card" th:classappend="${!n.isRead ? 'unread' : ''}">
                            <div class="notif-avatar-wrapper">
                                <img class="notif-avatar"
                                     th:src="${n.avatar != null ? n.avatar : '/img/default-avatar.png'}"
                                     onerror="this.src='/img/default-avatar.png'"
                                     th:alt="${n.senderName}">
                                <span class="avatar-status" th:if="${!n.isRead}"></span>
                            </div>

                            <div class="notif-content">
                                <div class="notif-header">
                                    <h3 class="notif-title" th:text="${n.title}">Notification Title</h3>
                                    <span class="notif-time">
                                        <i class="far fa-clock"></i>
                                        <span th:text="${#temporals.format(n.createdAt, 'dd/MM HH:mm')}"></span>
                                    </span>
                                </div>

                                <p class="notif-message" th:text="${n.message}">
                                    The notification content will be displayed here with full details...
                                </p>

                                <div class="notif-footer">
                                    <span class="tag tag-category">
                                        <i class="fas fa-bookmark"></i>
                                        <span th:text="${#strings.capitalize(#strings.replace(n.type, '_', ' ').toLowerCase())}">Category</span>
                                    </span>
                                    <span class="tag tag-user">
                                        <i class="fas fa-user"></i>
                                        <span th:text="${n.senderName}">Sender Name</span>
                                    </span>
                                </div>
                            </div>
                        </a>
                    </th:block>

                </div>

                <!-- Enhanced Pagination -->
                <div class="pagination-wrapper" th:if="${response.notifications.totalPages > 1}">
                    <nav class="pagination-custom" aria-label="Notification pagination">
                        <!-- Previous Button -->
                        <a th:href="@{/notification/all(
               page=${response.notifications.number - 1},
               size=${#lists.size(response.notifications.content)},
               status=${currentStatus},
               type=${currentType}
           )}"
                           class="page-link-custom"
                           th:classappend="${response.notifications.first ? 'disabled' : ''}"
                           aria-label="Previous page">
                            <i class="fas fa-chevron-left"></i>
                        </a>

                        <!-- Page Numbers -->
                        <th:block th:each="i : ${#numbers.sequence(0, response.notifications.totalPages - 1)}">
                            <a th:href="@{/notification/all(
                   page=${i},
                   size=${#lists.size(response.notifications.content)},
                   status=${currentStatus},
                   type=${currentType}
               )}"
                               class="page-link-custom"
                               th:classappend="${i == response.notifications.number ? 'active' : ''}"
                               th:text="${i + 1}"
                               th:aria-label="'Page ' + ${i + 1}">1</a>
                        </th:block>

                        <!-- Next Button -->
                        <a th:href="@{/notification/all(
               page=${response.notifications.number + 1},
               size=${#lists.size(response.notifications.content)},
               status=${currentStatus},
               type=${currentType}
           )}"
                           class="page-link-custom"
                           th:classappend="${response.notifications.last ? 'disabled' : ''}"
                           aria-label="Next page">
                            <i class="fas fa-chevron-right"></i>
                        </a>
                    </nav>
                </div>


            </section>
        </div>
    </div>
</main>

<!-- Loading Overlay -->
<div class="loading-overlay" id="loadingOverlay">
    <div class="spinner"></div>
</div>

<div th:replace="~{fragments/headerAndFooter :: footer}"></div>

<script>
    // Mark All As Read with Enhanced UX
    async function markAllAsRead() {
        const csrfMeta = document.querySelector('meta[name="_csrf"]');
        const csrfHeaderMeta = document.querySelector('meta[name="_csrf_header"]');

        if (!csrfMeta || !csrfHeaderMeta) {
            console.error("CSRF tokens not found");
            showToast('Security error', 'error');
            return;
        }

        const csrfToken = csrfMeta.getAttribute('content');
        const csrfHeader = csrfHeaderMeta.getAttribute('content');

        // Show loading overlay
        const loadingOverlay = document.getElementById('loadingOverlay');
        loadingOverlay.classList.add('active');

        const btn = document.querySelector('.btn-action');
        const originalHTML = btn.innerHTML;
        btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
        btn.disabled = true;

        try {
            const response = await fetch('/notification/mark-all-as-read', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    [csrfHeader]: csrfToken
                }
            });

            if (response.ok) {
                showToast('All notifications marked as read', 'success');
                setTimeout(() => {
                    window.location.reload();
                }, 1000);
            } else {
                throw new Error('Failed to update notifications');
            }
        } catch (error) {
            console.error('Error:', error);
            showToast('Could not update notifications. Please try again.', 'error');
            btn.innerHTML = originalHTML;
            btn.disabled = false;
            loadingOverlay.classList.remove('active');
        }
    }

    // Simple notification system

    // Add smooth scroll behavior
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                target.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        });
    });

    // Auto-refresh notification count every 30 seconds
    setInterval(() => {
        // You can implement AJAX call here to update counts
        console.log('Checking for new notifications...');
    }, 30000);
</script>

</body>
</html>
